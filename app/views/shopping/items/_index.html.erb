<div id='shopping_item_index'>
  <table class='shopping-item-index' align='center'>

    <thead>
    <th class='shopping-item-index left'>Piece</th>
    <th>&nbsp;</th>
    <th>Price</th>
    <th>Quantity</th>
    <th>Total</th>
    <th>&nbsp;</th>
    </thead>
    <tbody>
    <% total = 0 %>
    <% @cart.items.each do |item| %>
        <tr>
          <td class='shopping-item-index left'>
            <%= item.try(:offer).try(:name) %>
          </td>
          <td class='shopping-item-index'>
            <%= link_to image_tag(item.offer.image_url.to_s,
                                  :title => item.offer.name,
                                  :alt => item.offer.name,
                                  :width => '30%',
                                  :height => '30%',
                                  :class => "w280",
                                  :editable => "true",
                                  :label => "Image",
                                  :border => 0),
                        minisite_offer_url(item.offer),
                        {:style => "text-decoration: none;"} %>
          </td>
          <td class='shopping-item-index right'>
            <%= number_to_currency item.price.to_f %>
          </td>
          <td class='shopping-item-index right'>
            <%= item.quantity.to_i %>
          </td>
          <td class='shopping-item-index right'>
            <%= number_to_currency item.extension %>
          </td>
          <td class='shopping-item-index right'>
            <%= link_to 'Remove 1', remove_one_shopping_item_path(item), :method => :post, confirm: 'Are you sure?', :remote => true %>&nbsp; &nbsp;
            <%= link_to 'Remove all', shopping_item_path(item), :method => :delete, confirm: 'Are you sure?', :remote => true %>
          </td>
        </tr>
    <% end if @cart.items and @cart.items.present? %>
    <tr>
      <td class='shopping-item-index left'>Shipping</td>
      <td class='shopping-item-index'><%= @cart.shipping ? @cart.shipping.shipping_option : 'no shipping selected yet' %> </td>
      <td class='shopping-item-index'>&nbsp;</td>
      <td class='shopping-item-index'>&nbsp;</td>
      <td class='shopping-item-index right'><%= @cart.shipping ? number_to_currency(@cart.shipping.total_cents / 100.0) : 'n/a' %></td>
      <td class='shopping-item-index'>&nbsp;</td>
    </tr>
    <tr>
      <td class='shopping-item-index left'>Tax</td>
      <td class='shopping-item-index'><%= @cart.purchase ? '&nbsp;'.html_safe : 'tax calculated at checkout' %> </td>
      <td class='shopping-item-index'>&nbsp;</td>
      <td class='shopping-item-index'>&nbsp;</td>
      <td class='shopping-item-index right'><%= @cart.purchase ? number_to_currency(@cart.purchase.tax) : 'n/a' %></td>
      <td class='shopping-item-index'>&nbsp;</td>
    </tr>
    <tr>
      <td class='shopping-item-index left total'>Total</td>
      <td class='shopping-item-index total'>&nbsp;</td>
      <td class='shopping-item-index total'>&nbsp;</td>
      <td class='shopping-item-index right total'><%= @cart.quantity %></td>
      <td class='shopping-item-index right total'><%= number_to_currency(@cart.total) %></td>
      <td class='shopping-item-index total'>&nbsp;</td>
    </tr>
    </tbody>
  </table>
</div>